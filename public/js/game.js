!function(e){function t(a){if(r[a])return r[a].exports;var c=r[a]={exports:{},id:a,loaded:!1};return e[a].call(c.exports,c,c.exports,t),c.loaded=!0,c.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t){"use strict";function r(e){var t=e[0],r=e[1];return'<span class="player-1">'+t.name+'</span> vs <span class="player-2">'+r.name+"</span>"}function a(e){var t=e.length,r=e[0].length,a="";a+='<table class="field">';for(var c=0;c<t;c++){a+="<tr>";for(var o=0;o<r;o++)a+='<td id="'+c+"-"+o+'" class="tile '+e[c][o].type+'">'+(e[c][o].piece?"<span data-name='"+e[c][o].piece.type+"' class='piece player-"+e[c][o].piece.player+" "+e[c][o].piece.type.toLocaleLowerCase().replace(/ /g,"-")+"'>"+e[c][o].piece.type+"</span>":"")+"</td>";a+="</tr>"}return a+="</table>"}function c(e){var t="";return t+='<span class="">'+(5-e.back)+"</span>",t+=e.pieces.reduce(function(e,t){return'<span id="" class="">'+t.name+"</span>"},"")}function o(e,t){for(var r=e.length,c=e[0].length,o=document.getElementById("info"),p=function(p){for(var m=function(m){var u=document.getElementById(p+"-"+m);1===t&&(p!==r-1||0===m||m===c-1)||2===t&&(0!==p||0===m||m===c-1)?u.className+=" forbidden":u.addEventListener("click",function(r){e[p][m].piece={type:"King",player:1===t?2:1},document.getElementById("field").innerHTML=a(e),i.emit("king",{position:{i:p,j:m}}),o.innerHTML="Waiting on your rival to place your king ..."})},u=0;u<c;u++)m(u)},m=0;m<r;m++)p(m)}function p(e,t){var r=t.find(function(t){return t.id!==e.id});return r.level>=e.level?33:33-(e.level-r.level)}function m(e,t,r){var a=document.getElementById("available-points"),c=document.getElementById("info"),o=parseInt(a.innerHTML,10),p=o-e.value;if(p>=0){var m=document.getElementById("capture-player-"+r);"General"===e.name&&document.getElementById("piece-select-general").remove(),"Royal Guard"===e.name&&m.innerHTML.indexOf("Royal Guard")>-1&&document.getElementById("piece-select-royal-guard").remove(),m.innerHTML+='<p><span data-name="'+e.name+'" class="piece player-'+r+" "+v(e.name)+'">'+e.name+"</span></p>"}p>0?(a.innerHTML=p,p<5&&document.getElementById("piece-select-general")&&document.getElementById("piece-select-general").remove(),p<4&&(document.getElementById("piece-select-royal-guard")&&document.getElementById("piece-select-royal-guard").remove(),document.getElementById("piece-select-tower")&&document.getElementById("piece-select-tower").remove()),p<3&&(document.getElementById("piece-select-archer")&&document.getElementById("piece-select-archer").remove(),document.getElementById("piece-select-bishop")&&document.getElementById("piece-select-bishop").remove(),document.getElementById("piece-select-knight")&&document.getElementById("piece-select-knight").remove(),document.getElementById("piece-select-lord")&&document.getElementById("piece-select-lord").remove()),p<2&&(document.getElementById("piece-select-lancer")&&document.getElementById("piece-select-lancer").remove(),document.getElementById("piece-select-slinger")&&document.getElementById("piece-select-slinger").remove())):(document.getElementById("pieces-container").remove(),c.innerHTML="<p>Place your selected pieces on the field ...</p>",Array.from(document.querySelectorAll("#capture-player-"+r+" p")).forEach(function(e){e.addEventListener("click",function(e){var a=e.target.dataset.name;this.remove(),u(a,t,r)})}))}function u(e,t,r){for(var c=t.length,o=t[0].length,p=document.getElementById("info"),m=function(m){for(var u=function(o){var u=document.getElementById(m+"-"+o);1===r&&0!==m&&1!==m&&2!==m||2===r&&m!==c-1&&m!==c-2&&m!==c-3||u.innerHTML||"river"===t[m][o].type?u.className.indexOf("forbidden")===-1&&(u.className+=" forbidden"):u.addEventListener("click",function(c){t[m][o].piece={type:e,player:r},document.getElementById("field").innerHTML=a(t),document.querySelectorAll("#capture-player-"+r+" p").length||!function(){var e=[];t.forEach(function(t,r){t.forEach(function(t,a){t.piece&&"King"!==t.piece.type&&e.push({type:t.piece.type,i:r,j:a})})}),i.emit("initial",{pieces:e}),p.innerHTML="Waiting on your rival to place his/her pieces ..."}()})},v=0;v<o;v++)u(v)},u=0;u<c;u++)m(u)}function v(e){return String(e).toLowerCase().replace(/ /g,"-")}function n(e,t,r,a){document.getElementById(r.i+"-"+r.j).className+=" selected";var c=e[r.i][r.j].type,o=t.action[c],p={};3===o.length?(p.i={start:Math.max(0,r.i-1),end:Math.min(e.length,r.i+1)},p.j={start:Math.max(0,r.j-1),end:Math.min(e[0].length,r.j+1)}):(p.i={start:Math.max(0,r.i-2),end:Math.min(e.length,r.i+2)},p.j={start:Math.max(0,r.j-2),end:Math.min(e[0].length,r.j+2)});var m=Math.floor(o.length/2);if(1===a)for(var u=p.i.end;u>=p.i.start;u--)for(var v=p.j.end;v>=p.j.start;v--)console.log(u+"-"+v),console.log(e[u][v]),console.log(o[u+(m-r.i)][v+(m-r.j)].move),console.log(o[u+(m-r.i)][v+(m-r.j)].capture);else for(var n=p.i.start;n<=p.i.end;n++)for(var i=p.j.start;i<=p.j.end;i++)console.log(n+"-"+i),console.log(e[n][i]),console.log(o[n+(m-r.i)][i+(m-r.j)].move),console.log(o[n+(m-r.i)][i+(m-r.j)].capture)}var i=io();i.on("game",function(e){console.log(e);var t=e.players,u=e.field,l=e.captured,d=(u.length,u[0].length,t.findIndex(function(e){return e.id===player.id})+1),s=0,g=[{name:"Pawn",value:1,action:{plain:[[{move:0,capture:1},{move:1,capture:0},{move:0,capture:1}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}]],hill:[[{move:0,capture:1},{move:1,capture:0},{move:0,capture:1}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}]],river:[[{move:0,capture:0},{move:1,capture:0},{move:0,capture:0}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}]]}},{name:"Slinger",value:2,action:{plain:[[{move:0,capture:0},{move:0,capture:0},{move:0,capture:1},{move:0,capture:0},{move:0,capture:0}],[{move:0,capture:0},{move:0,capture:0},{move:1,capture:0},{move:0,capture:0},{move:0,capture:0}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}]],hill:[[{move:0,capture:0},{move:0,capture:0},{move:0,capture:2},{move:0,capture:0},{move:0,capture:0}],[{move:0,capture:0},{move:0,capture:0},{move:1,capture:0},{move:0,capture:0},{move:0,capture:0}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}]],river:[[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}],[{move:0,capture:0},{move:0,capture:0},{move:1,capture:0},{move:0,capture:0},{move:0,capture:0}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}]]}},{name:"Lancer",value:2,action:{plain:[[{move:0,capture:0},{move:1,capture:2},{move:0,capture:0}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}]],hill:[[{move:0,capture:0},{move:1,capture:2},{move:0,capture:0}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}]],river:[[{move:0,capture:0},{move:1,capture:0},{move:0,capture:0}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}]]}},{name:"Archer",value:3,action:{plain:[[{move:0,capture:0},{move:0,capture:1},{move:0,capture:1},{move:0,capture:1},{move:0,capture:0}],[{move:0,capture:1},{move:0,capture:0},{move:1,capture:0},{move:0,capture:0},{move:0,capture:1}],[{move:0,capture:1},{move:1,capture:0},{move:0,capture:0},{move:1,capture:0},{move:0,capture:1}],[{move:0,capture:0},{move:0,capture:0},{move:1,capture:0},{move:0,capture:0},{move:0,capture:0}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}]],hill:[[{move:0,capture:1},{move:0,capture:2},{move:0,capture:2},{move:0,capture:2},{move:0,capture:1}],[{move:0,capture:2},{move:0,capture:0},{move:1,capture:0},{move:0,capture:0},{move:0,capture:2}],[{move:0,capture:2},{move:1,capture:0},{move:0,capture:0},{move:1,capture:0},{move:0,capture:2}],[{move:0,capture:0},{move:0,capture:0},{move:1,capture:0},{move:0,capture:0},{move:0,capture:0}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}]],river:[[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}],[{move:0,capture:0},{move:0,capture:0},{move:1,capture:0},{move:0,capture:0},{move:0,capture:0}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}]]}},{name:"Lord",value:3,action:{plain:[[{move:1,capture:1},{move:1,capture:1},{move:1,capture:1}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}],[{move:1,capture:1},{move:0,capture:0},{move:1,capture:1}]],hill:[[{move:1,capture:1},{move:1,capture:1},{move:1,capture:1}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}],[{move:1,capture:1},{move:0,capture:0},{move:1,capture:1}]],river:[[{move:0,capture:0},{move:1,capture:0},{move:0,capture:0}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}]]}},{name:"Knight",value:3,action:{plain:[[{move:0,capture:0},{move:1,capture:1},{move:0,capture:0},{move:1,capture:1},{move:0,capture:0}],[{move:1,capture:1},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:1,capture:1}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:1},{move:0,capture:0},{move:0,capture:0}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}]],hill:[[{move:0,capture:0},{move:1,capture:1},{move:0,capture:0},{move:1,capture:1},{move:0,capture:0}],[{move:1,capture:1},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:1,capture:1}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:1},{move:0,capture:0},{move:0,capture:0}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}]],river:[[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}],[{move:0,capture:0},{move:0,capture:0},{move:1,capture:0},{move:0,capture:0},{move:0,capture:0}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}]]}},{name:"Bishop",value:3,action:{plain:[[{move:2,capture:2},{move:0,capture:0},{move:2,capture:2}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}],[{move:2,capture:2},{move:0,capture:0},{move:2,capture:2}]],hill:[[{move:1,capture:1},{move:0,capture:0},{move:1,capture:1}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}],[{move:1,capture:1},{move:0,capture:0},{move:1,capture:1}]],river:[[{move:0,capture:0},{move:1,capture:0},{move:0,capture:0}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}]]}},{name:"Tower",value:4,action:{plain:[[{move:0,capture:0},{move:10,capture:10},{move:0,capture:0}],[{move:10,capture:10},{move:0,capture:0},{move:10,capture:10}],[{move:0,capture:0},{move:10,capture:10},{move:0,capture:0}]],hill:[[{move:0,capture:0},{move:1,capture:1},{move:0,capture:0}],[{move:1,capture:1},{move:0,capture:0},{move:1,capture:1}],[{move:0,capture:0},{move:1,capture:1},{move:0,capture:0}]],river:[[{move:0,capture:0},{move:1,capture:0},{move:0,capture:0}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}]]}},{name:"Royal Guard",value:4,action:{plain:[[{move:2,capture:2},{move:2,capture:2},{move:2,capture:2}],[{move:2,capture:2},{move:0,capture:0},{move:2,capture:2}],[{move:0,capture:0},{move:1,capture:1},{move:0,capture:0}]],hill:[[{move:1,capture:1},{move:1,capture:1},{move:1,capture:1}],[{move:1,capture:1},{move:0,capture:0},{move:1,capture:1}],[{move:0,capture:0},{move:1,capture:1},{move:0,capture:0}]],river:[[{move:0,capture:0},{move:1,capture:0},{move:0,capture:0}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}]]}},{name:"General",value:5,action:{plain:[[{move:10,capture:10},{move:10,capture:10},{move:10,capture:10}],[{move:10,capture:10},{move:0,capture:0},{move:10,capture:10}],[{move:10,capture:10},{move:10,capture:10},{move:10,capture:10}]],hill:[[{move:1,capture:1},{move:1,capture:1},{move:1,capture:1}],[{move:1,capture:1},{move:0,capture:0},{move:1,capture:1}],[{move:1,capture:1},{move:1,capture:1},{move:1,capture:1}]],river:[[{move:0,capture:0},{move:1,capture:0},{move:0,capture:0}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}],[{move:0,capture:0},{move:0,capture:0},{move:0,capture:0}]]}}],y=document.getElementById("players"),f=document.getElementById("field"),h=document.getElementById("info"),E=document.getElementById("capture-player-1"),I=document.getElementById("capture-player-2");y.innerHTML=r(t),f.innerHTML=a(u),h.innerHTML="",h.innerHTML="Place the rival's King in the last row!",player.id===t[0].id?E.innerHTML='<span class="piece player-2 king" id="place-king">King</span>':I.innerHTML='<span class="piece player-1 king" id="place-king">King</span>',document.getElementById("place-king").addEventListener("click",function(e){this.remove(),o(u,d)}),i.on("king",function(e){console.log(e),u=e.field,f.innerHTML=a(u),h.innerHTML="",h.innerHTML="Select your pieces for this game ...",h.innerHTML+='<br>Points available: <span id="available-points">'+p(player,t)+"</span>",h.innerHTML+='\n            <div class="pieces-container" id="pieces-container">\n                  '+g.map(function(e){return'\n                        <span class="piece player-'+d+" "+v(e.name)+'" id="piece-select-'+v(e.name)+'" data-name="'+v(e.name)+'">\n                            '+e.name+"\n                        </span>"})+"\n            </div>\n        ",Array.from(document.querySelectorAll(".piece")).forEach(function(e){e.addEventListener("click",function(e){var t=e.target.dataset.name,r=g.find(function(e){return v(e.name)===t});m(r,u,d)})})}),i.on("turn",function(e){console.log(e),u=e.field,l=e.captured,s=e.turn,f.innerHTML=a(u),E.innerHTML=c(l[0]),I.innerHTML=c(l[1]),s%2===0?player.id===t[0].id?h.innerHTML="Waiting for your rival to play ...":(h.innerHTML="Your turn!",Array.from(document.querySelectorAll(".piece.player-2")).forEach(function(e){e.addEventListener("click",function(e){console.log(e);var t=g.find(function(t){return t.name===e.target.dataset.name}),r={i:parseInt(e.target.parentNode.id.split("-")[0],10),j:parseInt(e.target.parentNode.id.split("-")[1],10)};document.getElementById("field").innerHTML=a(u),n(u,t,r,d),document.getElementById(r.i+"-"+r.j).addEventListener("click",function(e){document.getElementById("field").innerHTML=a(u)})})})):player.id===t[0].id?(h.innerHTML="Your turn!",Array.from(document.querySelectorAll(".piece.player-1")).forEach(function(e){e.addEventListener("click",function(e){console.log(e);var t=g.find(function(t){return t.name===e.target.dataset.name}),r={i:parseInt(e.target.parentNode.id.split("-")[0],10),j:parseInt(e.target.parentNode.id.split("-")[1],10)};document.getElementById("field").innerHTML=a(u),n(u,t,r,d),document.getElementById(r.i+"-"+r.j).addEventListener("click",function(e){document.getElementById("field").innerHTML=a(u)})})})):h.innerHTML="Waiting for your rival to play ..."})})}]);