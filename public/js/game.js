!function(e){function t(a){if(r[a])return r[a].exports;var c=r[a]={exports:{},id:a,loaded:!1};return e[a].call(c.exports,c,c.exports,t),c.loaded=!0,c.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){"use strict";function a(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var c=r(1),o=r(2),p=r(3),u=r(6),m=r(7),v=r(12),n=r(4),i=r(9),l=r(5),s=r(10),d=io();d.on("game",function(e){console.log(e);var t=e.players,r=e.field,y=e.captured,f=(r.length,r[0].length,t.findIndex(function(e){return e.id===player.id})+1),g=0,h=document.getElementById("players"),E=document.getElementById("field"),I=document.getElementById("info"),L=document.getElementById("capture-player-1"),B=document.getElementById("capture-player-2");h.innerHTML=s(t),E.innerHTML=l(r),I.innerHTML="",I.innerHTML="Place the rival's King in the last row!",player.id===t[0].id?L.innerHTML='<span class="piece player-2 king" id="place-king">King</span>':B.innerHTML='<span class="piece player-1 king" id="place-king">King</span>',document.getElementById("place-king").addEventListener("click",function(e){var t=c.find(function(e){return"King"===e.type});this.remove(),n(t,r,f,d)}),d.on("king",function(e){console.log(e),r=e.field,E.innerHTML=l(r),I.innerHTML="",I.innerHTML="Select your pieces for this game ...",I.innerHTML+='<br>Points available: <span id="available-points">'+u(player,t)+"</span>",I.innerHTML+='\n            <div class="pieces-container" id="pieces-container">\n                  '+c.filter(function(e){return e.value}).map(function(e){return'\n                        <span class="piece player-'+f+" "+o(e.type)+'" id="piece-select-'+o(e.type)+'" data-type="'+o(e.type)+'">\n                            '+e.type+"\n                        </span>"})+"\n            </div>\n        ",Array.from(document.querySelectorAll(".piece")).forEach(function(e){e.addEventListener("click",function(e){var t=e.target.dataset.type,a=c.find(function(e){return o(e.type)===t});p(a,r,f,d)})})}),d.on("turn",function(e){console.log(e),r=e.field,y=e.captured,g=e.turn,E.innerHTML=l(r),L.innerHTML=i(y[0]),B.innerHTML=i(y[1]),document.querySelector("table.field").addEventListener("click",function(e){return v(e,r,c,d)}),g%2===0&&1===f||g%2===1&&2===f?I.innerHTML="Waiting for your rival to play ...":(I.innerHTML="Your turn!",Array.from(document.querySelectorAll(".piece.player-"+f)).forEach(function(e){e.addEventListener("click",function(e){var t=c.find(function(t){return t.type===e.target.dataset.type}),o={i:parseInt(e.target.parentNode.id.split("-")[0],10),j:parseInt(e.target.parentNode.id.split("-")[1],10)};[].concat(a(document.querySelectorAll(".selected")),a(document.querySelectorAll(".move")),a(document.querySelectorAll(".capture"))).forEach(function(e){e.classList.remove("selected"),e.classList.remove("move"),e.classList.remove("capture")}),m(r,t,o,f)})}))})})},function(e,t){"use strict";var r=[{type:"Pawn",value:1,infighting:!0,action:{plain:[[{move:!1,capture:!0},{move:!0,capture:!1},{move:!1,capture:!0}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}]],hill:[[{move:!1,capture:!0},{move:!0,capture:!1},{move:!1,capture:!0}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}]],river:[[{move:!1,capture:!1},{move:!0,capture:!1},{move:!1,capture:!1}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}]]}},{type:"Slinger",value:2,infighting:!1,action:{plain:[[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!0},{move:!1,capture:!1},{move:!1,capture:!1}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!0,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}]],hill:[[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!0},{move:!1,capture:!1},{move:!1,capture:!1}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!0,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}]],river:[[{move:!1,capture:!1},{move:!0,capture:!1},{move:!1,capture:!1}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}]]}},{type:"Lancer",value:2,infighting:!0,action:{plain:[[{move:!1,capture:!1},{move:!0,capture:!0},{move:!1,capture:!1}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}]],hill:[[{move:!1,capture:!1},{move:!0,capture:!0},{move:!1,capture:!1}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}]],river:[[{move:!1,capture:!1},{move:!0,capture:!1},{move:!1,capture:!1}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}]]}},{type:"Archer",value:3,infighting:!1,action:{plain:[[{move:!1,capture:!1},{move:!1,capture:!0},{move:!1,capture:!0},{move:!1,capture:!0},{move:!1,capture:!1}],[{move:!1,capture:!0},{move:!1,capture:!1},{move:!0,capture:!1},{move:!1,capture:!1},{move:!1,capture:!0}],[{move:!1,capture:!0},{move:!0,capture:!1},{move:!1,capture:!1},{move:!0,capture:!1},{move:!1,capture:!0}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!0,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}]],hill:[[{move:!1,capture:!0},{move:!1,capture:!0},{move:!1,capture:!0},{move:!1,capture:!0},{move:!1,capture:!0}],[{move:!1,capture:!0},{move:!1,capture:!1},{move:!0,capture:!1},{move:!1,capture:!1},{move:!1,capture:!0}],[{move:!1,capture:!0},{move:!0,capture:!1},{move:!1,capture:!1},{move:!0,capture:!1},{move:!1,capture:!0}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!0,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}]],river:[[{move:!1,capture:!1},{move:!0,capture:!1},{move:!1,capture:!1}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}]]}},{type:"Lord",value:3,infighting:!0,action:{plain:[[{move:!0,capture:!0},{move:!0,capture:!0},{move:!0,capture:!0}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}],[{move:!0,capture:!0},{move:!1,capture:!1},{move:!0,capture:!0}]],hill:[[{move:!0,capture:!0},{move:!0,capture:!0},{move:!0,capture:!0}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}],[{move:!0,capture:!0},{move:!1,capture:!1},{move:!0,capture:!0}]],river:[[{move:!1,capture:!1},{move:!0,capture:!1},{move:!1,capture:!1}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}]]}},{type:"Knight",value:3,infighting:!0,action:{plain:[[{move:!1,capture:!1},{move:!0,capture:!0},{move:!1,capture:!1},{move:!0,capture:!0},{move:!1,capture:!1}],[{move:!0,capture:!0},{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1},{move:!0,capture:!0}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!0},{move:!1,capture:!1},{move:!1,capture:!1}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}]],hill:[[{move:!1,capture:!1},{move:!0,capture:!0},{move:!1,capture:!1},{move:!0,capture:!0},{move:!1,capture:!1}],[{move:!0,capture:!0},{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1},{move:!0,capture:!0}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!0},{move:!1,capture:!1},{move:!1,capture:!1}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}]],river:[[{move:!1,capture:!1},{move:!0,capture:!1},{move:!1,capture:!1}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}]]}},{type:"Bishop",value:3,infighting:!0,action:{plain:[[{move:!0,capture:!0},{move:!1,capture:!1},{move:!0,capture:!0}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}],[{move:!0,capture:!0},{move:!1,capture:!1},{move:!0,capture:!0}]],hill:[[{move:!0,capture:!0},{move:!1,capture:!1},{move:!0,capture:!0}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}],[{move:!0,capture:!0},{move:!1,capture:!1},{move:!0,capture:!0}]],river:[[{move:!1,capture:!1},{move:!0,capture:!1},{move:!1,capture:!1}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}]]}},{type:"Tower",value:4,infighting:!0,action:{plain:[[{move:!1,capture:!1},{move:!0,capture:!0},{move:!1,capture:!1}],[{move:!0,capture:!0},{move:!1,capture:!1},{move:!0,capture:!0}],[{move:!1,capture:!1},{move:!0,capture:!0},{move:!1,capture:!1}]],hill:[[{move:!1,capture:!1},{move:!0,capture:!0},{move:!1,capture:!1}],[{move:!0,capture:!0},{move:!1,capture:!1},{move:!0,capture:!0}],[{move:!1,capture:!1},{move:!0,capture:!0},{move:!1,capture:!1}]],river:[[{move:!1,capture:!1},{move:!0,capture:!1},{move:!1,capture:!1}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}]]}},{type:"Royal Guard",value:4,infighting:!0,action:{plain:[[{move:!0,capture:!0},{move:!0,capture:!0},{move:!0,capture:!0}],[{move:!0,capture:!0},{move:!1,capture:!1},{move:!0,capture:!0}],[{move:!1,capture:!1},{move:!0,capture:!0},{move:!1,capture:!1}]],hill:[[{move:!0,capture:!0},{move:!0,capture:!0},{move:!0,capture:!0}],[{move:!0,capture:!0},{move:!1,capture:!1},{move:!0,capture:!0}],[{move:!1,capture:!1},{move:!0,capture:!0},{move:!1,capture:!1}]],river:[[{move:!1,capture:!1},{move:!0,capture:!1},{move:!1,capture:!1}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}]]}},{type:"General",value:5,infighting:!0,action:{plain:[[{move:!0,capture:!0},{move:!0,capture:!0},{move:!0,capture:!0}],[{move:!0,capture:!0},{move:!1,capture:!1},{move:!0,capture:!0}],[{move:!0,capture:!0},{move:!0,capture:!0},{move:!0,capture:!0}]],hill:[[{move:!0,capture:!0},{move:!0,capture:!0},{move:!0,capture:!0}],[{move:!0,capture:!0},{move:!1,capture:!1},{move:!0,capture:!0}],[{move:!0,capture:!0},{move:!0,capture:!0},{move:!0,capture:!0}]],river:[[{move:!1,capture:!1},{move:!0,capture:!1},{move:!1,capture:!1}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}]]}},{type:"King",value:0,infighting:!0,action:{plain:[[{move:!0,capture:!0},{move:!0,capture:!0},{move:!0,capture:!0}],[{move:!0,capture:!0},{move:!1,capture:!1},{move:!0,capture:!0}],[{move:!0,capture:!0},{move:!0,capture:!0},{move:!0,capture:!0}]],hill:[[{move:!0,capture:!0},{move:!0,capture:!0},{move:!0,capture:!0}],[{move:!0,capture:!0},{move:!1,capture:!1},{move:!0,capture:!0}],[{move:!0,capture:!0},{move:!0,capture:!0},{move:!0,capture:!0}]],river:[[{move:!1,capture:!1},{move:!0,capture:!1},{move:!1,capture:!1}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}],[{move:!1,capture:!1},{move:!1,capture:!1},{move:!1,capture:!1}]]}}];e.exports=r},function(e,t){"use strict";e.exports=function(e){if("string"!=typeof e)throw new TypeError("expected a string");return e=e.replace(/([a-z])([A-Z])/g,"$1-$2"),e=e.replace(/[ \t\W]/g,"-"),e=e.replace(/^-+|-+$/g,""),e.toLowerCase()}},function(e,t,r){"use strict";var a=r(2),c=r(4),o=function(e,t,r,o){var p=document.getElementById("available-points"),u=document.getElementById("info"),m=parseInt(p.innerHTML,10),v=m-e.value;if(v>=0){var n=document.getElementById("capture-player-"+r);"General"===e.type&&document.getElementById("piece-select-general").remove(),"Royal Guard"===e.type&&n.innerHTML.indexOf("Royal Guard")>-1&&document.getElementById("piece-select-royal-guard").remove(),n.innerHTML+='<p><span data-type="'+e.type+'" class="piece player-'+r+" "+a(e.type)+'">'+e.type+"</span></p>"}v>0?(p.innerHTML=v,v<5&&document.getElementById("piece-select-general")&&document.getElementById("piece-select-general").remove(),v<4&&(document.getElementById("piece-select-royal-guard")&&document.getElementById("piece-select-royal-guard").remove(),document.getElementById("piece-select-tower")&&document.getElementById("piece-select-tower").remove()),v<3&&(document.getElementById("piece-select-archer")&&document.getElementById("piece-select-archer").remove(),document.getElementById("piece-select-bishop")&&document.getElementById("piece-select-bishop").remove(),document.getElementById("piece-select-knight")&&document.getElementById("piece-select-knight").remove(),document.getElementById("piece-select-lord")&&document.getElementById("piece-select-lord").remove()),v<2&&(document.getElementById("piece-select-lancer")&&document.getElementById("piece-select-lancer").remove(),document.getElementById("piece-select-slinger")&&document.getElementById("piece-select-slinger").remove())):(document.getElementById("pieces-container").remove(),u.innerHTML="<p>Place your selected pieces on the field ...</p>",Array.from(document.querySelectorAll("#capture-player-"+r+" p")).forEach(function(e){e.addEventListener("click",function(e){var a=e.target.dataset.type;this.remove(),c(a,t,r,o)})}))};e.exports=o},function(e,t,r){"use strict";var a=r(5),c=function(e,t,r,c){var o=t.length,p=t[0].length,u=document.getElementById("info");if("King"===e.type)for(var m=function(e){for(var m=function(m){var v=document.getElementById(e+"-"+m);1===r&&(e!==o-1||0===m||m===p-1)||2===r&&(0!==e||0===m||m===p-1)?v.className+=" forbidden":v.addEventListener("click",function(o){t[e][m].piece={type:"King",player:1===r?2:1},document.getElementById("field").innerHTML=a(t),c.emit("king",{position:{i:e,j:m}}),u.innerHTML="Waiting on your rival to place your king ..."})},v=0;v<p;v++)m(v)},v=0;v<o;v++)m(v);else for(var n=function(m){for(var v=function(p){var v=document.getElementById(m+"-"+p);1===r&&0!==m&&1!==m&&2!==m||2===r&&m!==o-1&&m!==o-2&&m!==o-3||v.innerHTML||"river"===t[m][p].type?v.className.indexOf("forbidden")===-1&&(v.className+=" forbidden"):v.addEventListener("click",function(o){t[m][p].piece={type:e,player:r},document.getElementById("field").innerHTML=a(t),document.querySelectorAll("#capture-player-"+r+" p").length||!function(){var e=[];t.forEach(function(t,r){t.forEach(function(t,a){t.piece&&"King"!==t.piece.type&&e.push({type:t.piece.type,i:r,j:a})})}),c.emit("initial",{pieces:e}),u.innerHTML="Waiting on your rival to place his/her pieces ..."}()})},n=0;n<p;n++)v(n)},i=0;i<o;i++)n(i)};e.exports=c},function(e,t,r){"use strict";var a=r(2),c=function(e){var t=e.length,r=e[0].length,c="";c+='<table class="field">';for(var o=0;o<t;o++){c+="<tr>";for(var p=0;p<r;p++)c+='<td id="'+o+"-"+p+'" class="tile '+e[o][p].type+'">'+(e[o][p].piece?"<span data-type='"+e[o][p].piece.type+"' class='piece player-"+e[o][p].piece.player+" "+a(e[o][p].piece.type)+"'>"+e[o][p].piece.type+"</span>":"")+"</td>";c+="</tr>"}return c+="</table>"};e.exports=c},function(e,t){"use strict";var r=function(e,t){var r=t.find(function(t){return t.id!==e.id});return r.level>=e.level?33:33-(e.level-r.level)};e.exports=r},function(e,t,r){"use strict";var a=r(8),c=function(e,t,r,c){document.getElementById(r.i+"-"+r.j).className+=" selected";for(var o=e[r.i][r.j].type,p=1===c?a(t.action[o],2):t.action[o],u=Math.floor(p.length/2),m={i:{start:Math.max(0,r.i-u),end:Math.min(e.length-1,r.i+u)},j:{start:Math.max(0,r.j-u),end:Math.min(e[0].length-1,r.j+u)}},v={i:u-r.i,j:u-r.j},n=m.i.start;n<=m.i.end;n++)for(var i=m.j.start;i<=m.j.end;i++){var l=document.getElementById(n+"-"+i),s=p[n+v.i][i+v.j].move,d=p[n+v.i][i+v.j].capture;s&&!e[n][i].piece&&(l.className+=" move"),d&&e[n][i].piece&&e[n][i].piece.player!==c&&(l.className+=" capture")}};e.exports=c},function(e,t,r){!function(r){"use strict";function a(e,t){if(!(Array.isArray(e)&&e.length>0))return[];if("number"!=typeof t)t=1;else if(0===t)return e;for(var r=[],c=0,o=e.length;c<o;c++){for(var p=0,u=e[c].length;p<u;p++){if(o!==u)return[];r[c]=r[c]||[],r[c][p]=e[p][c]}t>0&&(r[c]=r[c].reverse())}for(t<0&&r.reverse();t>0?t--:t++;)r=a(r,t);return r}"undefined"!=typeof e&&e.exports&&(t=e.exports=a),t.rotateMatrix=a}(this)},function(e,t,r){"use strict";var a=r(2),c=function(e){var t="";return t+='<p><span class="captured-back">'+(5-e.back)+"</span></p>",t+=e.pieces.reduce(function(e,t){return e+('<p><span data-type="'+t.type+'" class="piece player-'+t.player+'" '+a(t.type)+">"+t.type+"</span></p>")},"")};e.exports=c},function(e,t){"use strict";var r=function(e){var t=e[0],r=e[1];return'<span class="player-1">'+t.name+'</span> vs <span class="player-2">'+r.name+"</span>"};e.exports=r},,function(e,t){"use strict";var r=function(e,t,r,a){var c=document.querySelector(".selected"),o=c.id,p={i:parseInt(o.split("-")[0],10),j:parseInt(o.split("-")[1],10)},u=e.target.id,m={i:parseInt(u.split("-")[0],10),j:parseInt(u.split("-")[1],10)},v=r.find(function(e){return e.type===c.children[0].dataset.type});e.target&&e.target.matches(".move")?a.emit("turn",{type:"move",piece:v,start:p,end:m}):e.target&&e.target.matches(".capture")&&a.emit("turn",{type:"capture",piece:v,start:p,end:m})};e.exports=r}]);